CREATE TABLE migrantw (	
	enroll_id NUMBER PRIMARY KEY, 
	name VARCHAR(64) NOT NULL, 
	skill VARCHAR2(64) NOT NULL, 
	address VARCHAR(32) NOT NULL, 
	pjobloc VARCHAR2(64) NOT NULL, 
	ph_no CHAR(10) NOT NULL, 
	enroll_date DATE NOT NULL,
	status CHAR(1) NOT NULL
);

INSERT INTO migrantw VALUES (1, 'Ruchit Jain', 'TV Mechanic, Electrician', 'Bangalore, KA', 'Mumbai, Bangalore, Delhi', '9876543210', DATE '2020-03-13', 'U');
INSERT INTO migrantw VALUES (2, 'Pranab Jaiswal', 'Electrician, Carpenter, TV Mechanic', 'Mumbai, MH', 'Mumbai, Noida, Delhi', '9898656532', DATE '2020-04-12', 'U');
INSERT INTO migrantw VALUES (3, 'Ankit Singh', 'TV Mechanic, Carpenter', 'Channai, TN', 'Mumbai, Noida, Delhi', '9960754382', DATE '2020-03-23', 'U');
INSERT INTO migrantw VALUES (4, 'Nalin Gowd', 'Carpenter, Electrician', 'Mumbai, MH', 'Bangalore, Mumbai', '9473205723', DATE '2020-01-30', 'U');
INSERT INTO migrantw VALUES (5, 'Prakash Janwar', 'TV Mechanic, Electrician', 'Lucknow, UP', 'Mumbai, Chennai, Noida', '8196385035', DATE '2020-05-17', 'U');
INSERT INTO migrantw VALUES (6, 'Pramod Lolak', 'TV Mechanic, Carpenter', 'Mangalore, KA', 'Mumbai, Delhi, Chennai', '9539667282', DATE '2020-06-21', 'U');
INSERT INTO migrantw VALUES (7, 'Ruchit Jain', 'TV Mechanic, Electrician', 'Bangalore, KA', 'Mumbai, Bangalore, Delhi', '9876543210', DATE '2020-03-13', 'U');
INSERT INTO migrantw VALUES (8, 'Pranab Jaiswal', 'Electrician, Carpenter, TV Mechanic', 'Mumbai, MH', 'Mumbai, Noida, Delhi', '9898656532', DATE '2020-04-12', 'U');
INSERT INTO migrantw VALUES (9, 'Ankit Singh', 'TV Mechanic, Carpenter', 'Channai, TN', 'Mumbai, Noida, Delhi', '9960754382', DATE '2020-03-23', 'U');
INSERT INTO migrantw VALUES (10, 'Nalin Gowd', 'Carpenter, Electrician', 'Mumbai, MH', 'Bangalore, Mumbai', '9473205723', DATE '2020-01-30', 'U');
INSERT INTO migrantw VALUES (11, 'Prakash Janwar', 'TV Mechanic, Electrician', 'Lucknow, UP', 'Mumbai, Chennai, Noida', '8196385035', DATE '2020-05-17', 'U');
INSERT INTO migrantw VALUES (12, 'Pramod Lolak', 'TV Mechanic, Carpenter', 'Mangalore, KA', 'Mumbai, Delhi, Chennai', '9539667282', DATE '2020-06-21', 'U');
INSERT INTO migrantw VALUES (13, 'Ruchit Jain', 'TV Mechanic, Electrician', 'Bangalore, KA', 'Mumbai, Bangalore, Delhi', '9876543210', DATE '2020-03-13', 'U');
INSERT INTO migrantw VALUES (14, 'Pranab Jaiswal', 'Electrician, Carpenter, TV Mechanic', 'Mumbai, MH', 'Mumbai, Noida, Delhi', '9898656532', DATE '2020-04-12', 'U');
INSERT INTO migrantw VALUES (15, 'Ankit Singh', 'TV Mechanic, Carpenter', 'Channai, TN', 'Mumbai, Noida, Delhi', '9960754382', DATE '2020-03-23', 'U');
INSERT INTO migrantw VALUES (16, 'Nalin Gowd', 'Carpenter, Electrician', 'Mumbai, MH', 'Bangalore, Mumbai', '9473205723', DATE '2020-01-30', 'U');
INSERT INTO migrantw VALUES (17, 'Prakash Janwar', 'TV Mechanic, Electrician', 'Lucknow, UP', 'Mumbai, Chennai, Noida', '8196385035', DATE '2020-05-17', 'U');
INSERT INTO migrantw VALUES (18, 'Pramod Lolak', 'TV Mechanic, Carpenter', 'Mangalore, KA', 'Mumbai, Delhi, Chennai', '9539667282', DATE '2020-06-21', 'U');
INSERT INTO migrantw VALUES (19, 'Ruchit Jain', 'TV Mechanic, Electrician', 'Bangalore, KA', 'Mumbai, Bangalore, Delhi', '9876543210', DATE '2020-03-13', 'U');
INSERT INTO migrantw VALUES (20, 'Pranab Jaiswal', 'Electrician, Carpenter, TV Mechanic', 'Mumbai, MH', 'Mumbai, Noida, Delhi', '9898656532', DATE '2020-04-12', 'U');
INSERT INTO migrantw VALUES (21, 'Ankit Singh', 'TV Mechanic, Carpenter', 'Channai, TN', 'Mumbai, Noida, Delhi', '9960754382', DATE '2020-03-23', 'U');
INSERT INTO migrantw VALUES (22, 'Nalin Gowd', 'Carpenter, Electrician', 'Mumbai, MH', 'Bangalore, Mumbai', '9473205723', DATE '2020-01-30', 'U');
INSERT INTO migrantw VALUES (23, 'Prakash Janwar', 'TV Mechanic, Electrician', 'Lucknow, UP', 'Mumbai, Chennai, Noida', '8196385035', DATE '2020-05-17', 'U');
INSERT INTO migrantw VALUES (24, 'Pramod Lolak', 'TV Mechanic, Carpenter', 'Mangalore, KA', 'Mumbai, Delhi, Chennai', '9539667282', DATE '2020-06-21', 'U');
INSERT INTO migrantw VALUES (25, 'Ruchit Jain', 'TV Mechanic, Electrician', 'Bangalore, KA', 'Mumbai, Bangalore, Delhi', '9876543210', DATE '2020-03-13', 'U');
INSERT INTO migrantw VALUES (26, 'Pranab Jaiswal', 'Electrician, Carpenter, TV Mechanic', 'Mumbai, MH', 'Mumbai, Noida, Delhi', '9898656532', DATE '2020-04-12', 'U');
INSERT INTO migrantw VALUES (27, 'Ankit Singh', 'TV Mechanic, Carpenter', 'Channai, TN', 'Mumbai, Noida, Delhi', '9960754382', DATE '2020-03-23', 'U');
INSERT INTO migrantw VALUES (28, 'Nalin Gowd', 'Carpenter, Electrician', 'Mumbai, MH', 'Bangalore, Mumbai', '9473205723', DATE '2020-01-30', 'U');
INSERT INTO migrantw VALUES (29, 'Prakash Janwar', 'TV Mechanic, Electrician', 'Lucknow, UP', 'Mumbai, Chennai, Noida', '8196385035', DATE '2020-05-17', 'U');
INSERT INTO migrantw VALUES (30, 'Pramod Lolak', 'TV Mechanic, Carpenter', 'Mangalore, KA', 'Mumbai, Delhi, Chennai', '9539667282', DATE '2020-06-21', 'U');
INSERT INTO migrantw VALUES (31, 'Ruchit Jain', 'TV Mechanic, Electrician', 'Bangalore, KA', 'Mumbai, Bangalore, Delhi', '9876543210', DATE '2020-03-13', 'U');
INSERT INTO migrantw VALUES (32, 'Pranab Jaiswal', 'Electrician, Carpenter, TV Mechanic', 'Mumbai, MH', 'Mumbai, Noida, Delhi', '9898656532', DATE '2020-04-12', 'U');
INSERT INTO migrantw VALUES (33, 'Ankit Singh', 'TV Mechanic, Carpenter', 'Channai, TN', 'Mumbai, Noida, Delhi', '9960754382', DATE '2020-03-23', 'U');
INSERT INTO migrantw VALUES (34, 'Nalin Gowd', 'Carpenter, Electrician', 'Mumbai, MH', 'Bangalore, Mumbai', '9473205723', DATE '2020-01-30', 'U');
INSERT INTO migrantw VALUES (35, 'Prakash Janwar', 'TV Mechanic, Electrician', 'Lucknow, UP', 'Mumbai, Chennai, Noida', '8196385035', DATE '2020-05-17', 'U');
INSERT INTO migrantw VALUES (36, 'Pramod Lolak', 'TV Mechanic, Carpenter', 'Mangalore, KA', 'Mumbai, Delhi, Chennai', '9539667282', DATE '2020-06-21', 'U');
INSERT INTO migrantw VALUES (37, 'Ruchit Jain', 'TV Mechanic, Electrician', 'Bangalore, KA', 'Mumbai, Bangalore, Delhi', '9876543210', DATE '2020-03-13', 'U');
INSERT INTO migrantw VALUES (38, 'Pranab Jaiswal', 'Electrician, Carpenter, TV Mechanic', 'Mumbai, MH', 'Mumbai, Noida, Delhi', '9898656532', DATE '2020-04-12', 'U');
INSERT INTO migrantw VALUES (39, 'Ankit Singh', 'TV Mechanic, Carpenter', 'Channai, TN', 'Mumbai, Noida, Delhi', '9960754382', DATE '2020-03-23', 'U');
INSERT INTO migrantw VALUES (40, 'Nalin Gowd', 'Carpenter, Electrician', 'Mumbai, MH', 'Bangalore, Mumbai', '9473205723', DATE '2020-01-30', 'U');
INSERT INTO migrantw VALUES (41, 'Prakash Janwar', 'TV Mechanic, Electrician', 'Lucknow, UP', 'Mumbai, Chennai, Noida', '8196385035', DATE '2020-05-17', 'U');
INSERT INTO migrantw VALUES (42, 'Pramod Lolak', 'TV Mechanic, Carpenter', 'Mangalore, KA', 'Mumbai, Delhi, Chennai', '9539667282', DATE '2020-06-21', 'U');
INSERT INTO migrantw VALUES (43, 'Ruchit Jain', 'TV Mechanic, Electrician', 'Bangalore, KA', 'Mumbai, Bangalore, Delhi', '9876543210', DATE '2020-03-13', 'U');
INSERT INTO migrantw VALUES (44, 'Pranab Jaiswal', 'Electrician, Carpenter, TV Mechanic', 'Mumbai, MH', 'Mumbai, Noida, Delhi', '9898656532', DATE '2020-04-12', 'U');
INSERT INTO migrantw VALUES (45, 'Ankit Singh', 'TV Mechanic, Carpenter', 'Channai, TN', 'Mumbai, Noida, Delhi', '9960754382', DATE '2020-03-23', 'U');
INSERT INTO migrantw VALUES (46, 'Nalin Gowd', 'Carpenter, Electrician', 'Mumbai, MH', 'Bangalore, Mumbai', '9473205723', DATE '2020-01-30', 'U');
INSERT INTO migrantw VALUES (47, 'Prakash Janwar', 'TV Mechanic, Electrician', 'Lucknow, UP', 'Mumbai, Chennai, Noida', '8196385035', DATE '2020-05-17', 'U');
INSERT INTO migrantw VALUES (48, 'Pramod Lolak', 'TV Mechanic, Carpenter', 'Mangalore, KA', 'Mumbai, Delhi, Chennai', '9539667282', DATE '2020-06-21', 'U');

SET AUTOTRACE ON;
SELECT * FROM migrantw WHERE skill LIKE '%Electrician%' AND pjobloc LIKE '%Mumbai%';
SET AUTOTRACE OFF;

-- creating the cluster
CREATE CLUSTER migrantw_cluster (skill VARCHAR2(64), pjobloc VARCHAR2(64));
-- creating the index on the cluster
CREATE INDEX migrantw_cluster_idx ON CLUSTER migrantw_cluster;

-- creating the tables
CREATE TABLE migrantw_mechanic_mumbai
CLUSTER migrantw_cluster (skill, pjobloc)
AS SELECT * FROM migrantw WHERE skill LIKE '%TV Mechanic%' AND pjobloc LIKE '%Mumbai%';

CREATE TABLE migrantw_mechanic_bangalore
CLUSTER migrantw_cluster (skill, pjobloc)
AS SELECT * FROM migrantw WHERE skill LIKE '%TV Mechanic%' AND pjobloc LIKE '%Bangalore%';

CREATE TABLE migrantw_mechanic_noida
CLUSTER migrantw_cluster (skill, pjobloc)
AS SELECT * FROM migrantw WHERE skill LIKE '%TV Mechanic%' AND pjobloc LIKE '%Noida%';

CREATE TABLE migrantw_mechanic_delhi
CLUSTER migrantw_cluster (skill, pjobloc)
AS SELECT * FROM migrantw WHERE skill LIKE '%TV Mechanic%' AND pjobloc LIKE '%Delhi%';

CREATE TABLE migrantw_mechanic_chennai
CLUSTER migrantw_cluster (skill, pjobloc)
AS SELECT * FROM migrantw WHERE skill LIKE '%TV Mechanic%' AND pjobloc LIKE '%Chennai%';

CREATE TABLE migrantw_carpenter_mumbai
CLUSTER migrantw_cluster (skill, pjobloc)
AS SELECT * FROM migrantw WHERE skill LIKE '%Carpenter%' AND pjobloc LIKE '%Mumbai%';

CREATE TABLE migrantw_carpenter_bangalore
CLUSTER migrantw_cluster (skill, pjobloc)
AS SELECT * FROM migrantw WHERE skill LIKE '%Carpenter%' AND pjobloc LIKE '%Bangalore%';

CREATE TABLE migrantw_carpenter_noida
CLUSTER migrantw_cluster (skill, pjobloc)
AS SELECT * FROM migrantw WHERE skill LIKE '%Carpenter%' AND pjobloc LIKE '%Noida%';

CREATE TABLE migrantw_carpenter_delhi
CLUSTER migrantw_cluster (skill, pjobloc)
AS SELECT * FROM migrantw WHERE skill LIKE '%Carpenter%' AND pjobloc LIKE '%Delhi%';

CREATE TABLE migrantw_carpenter_chennai
CLUSTER migrantw_cluster (skill, pjobloc)
AS SELECT * FROM migrantw WHERE skill LIKE '%Carpenter%' AND pjobloc LIKE '%Chennai%';

CREATE TABLE migrantw_electrician_mumbai
CLUSTER migrantw_cluster (skill, pjobloc)
AS SELECT * FROM migrantw WHERE skill LIKE '%Electrician%' AND pjobloc LIKE '%Mumbai%';

CREATE TABLE migrantw_electrician_bangalore
CLUSTER migrantw_cluster (skill, pjobloc)
AS SELECT * FROM migrantw WHERE skill LIKE '%Electrician%' AND pjobloc LIKE '%Bangalore%';

CREATE TABLE migrantw_electrician_noida
CLUSTER migrantw_cluster (skill, pjobloc)
AS SELECT * FROM migrantw WHERE skill LIKE '%Electrician%' AND pjobloc LIKE '%Noida%';

CREATE TABLE migrantw_electrician_delhi
CLUSTER migrantw_cluster (skill, pjobloc)
AS SELECT * FROM migrantw WHERE skill LIKE '%Electrician%' AND pjobloc LIKE '%Delhi%';

CREATE TABLE migrantw_electrician_chennai
CLUSTER migrantw_cluster (skill, pjobloc)
AS SELECT * FROM migrantw WHERE skill LIKE '%Electrician%' AND pjobloc LIKE '%Chennai%';

SET AUTOTRACE ON;
SELECT * FROM migrantw WHERE skill LIKE '%Electrician%' AND pjobloc LIKE '%Mumbai%';
SET AUTOTRACE OFF;

DROP INDEX migrantw_cluster_idx;
DROP CLUSTER migrantw_cluster INCLUDING TABLES;
DROP TABLE migrantw;
